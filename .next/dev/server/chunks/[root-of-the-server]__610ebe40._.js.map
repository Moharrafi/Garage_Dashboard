{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/gtavapor/lib/auth/session.ts"],"sourcesContent":["import crypto from \"crypto\"\n\nconst HEAD = Buffer.from(JSON.stringify({ alg: \"HS256\", typ: \"JWT\" })).toString(\"base64url\")\n\nfunction getSecret() {\n  const secret = process.env.APP_SESSION_SECRET\n  if (!secret) {\n    throw new Error(\"APP_SESSION_SECRET is required\")\n  }\n  return secret\n}\n\nfunction createSignature(data: string, secret: string) {\n  return crypto.createHmac(\"sha256\", secret).update(data).digest(\"base64url\")\n}\n\nexport async function createSessionToken(email: string) {\n  const secret = getSecret()\n  const issuedAt = Math.floor(Date.now() / 1000)\n  const expiresAt = issuedAt + 60 * 60 * 24 * 7 // 7 days\n  const payload = Buffer.from(JSON.stringify({ email, iat: issuedAt, exp: expiresAt })).toString(\"base64url\")\n  const signature = createSignature(`${HEAD}.${payload}`, secret)\n  return `${HEAD}.${payload}.${signature}`\n}\n\nexport async function verifySessionToken(token: string) {\n  try {\n    const secret = getSecret()\n    const [head, payload, signature] = token.split(\".\")\n    if (!head || !payload || !signature) return null\n    const expectedSignature = createSignature(`${head}.${payload}`, secret)\n    if (!crypto.timingSafeEqual(Buffer.from(signature), Buffer.from(expectedSignature))) {\n      return null\n    }\n    const data = JSON.parse(Buffer.from(payload, \"base64url\").toString(\"utf-8\"))\n    if (typeof data.exp !== \"number\" || data.exp * 1000 < Date.now()) {\n      return null\n    }\n    return data\n  } catch {\n    return null\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,OAAO,OAAO,IAAI,CAAC,KAAK,SAAS,CAAC;IAAE,KAAK;IAAS,KAAK;AAAM,IAAI,QAAQ,CAAC;AAEhF,SAAS;IACP,MAAM,SAAS,QAAQ,GAAG,CAAC,kBAAkB;IAC7C,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;AAEA,SAAS,gBAAgB,IAAY,EAAE,MAAc;IACnD,OAAO,gHAAM,CAAC,UAAU,CAAC,UAAU,QAAQ,MAAM,CAAC,MAAM,MAAM,CAAC;AACjE;AAEO,eAAe,mBAAmB,KAAa;IACpD,MAAM,SAAS;IACf,MAAM,WAAW,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;IACzC,MAAM,YAAY,WAAW,KAAK,KAAK,KAAK,EAAE,SAAS;;IACvD,MAAM,UAAU,OAAO,IAAI,CAAC,KAAK,SAAS,CAAC;QAAE;QAAO,KAAK;QAAU,KAAK;IAAU,IAAI,QAAQ,CAAC;IAC/F,MAAM,YAAY,gBAAgB,GAAG,KAAK,CAAC,EAAE,SAAS,EAAE;IACxD,OAAO,GAAG,KAAK,CAAC,EAAE,QAAQ,CAAC,EAAE,WAAW;AAC1C;AAEO,eAAe,mBAAmB,KAAa;IACpD,IAAI;QACF,MAAM,SAAS;QACf,MAAM,CAAC,MAAM,SAAS,UAAU,GAAG,MAAM,KAAK,CAAC;QAC/C,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,WAAW,OAAO;QAC5C,MAAM,oBAAoB,gBAAgB,GAAG,KAAK,CAAC,EAAE,SAAS,EAAE;QAChE,IAAI,CAAC,gHAAM,CAAC,eAAe,CAAC,OAAO,IAAI,CAAC,YAAY,OAAO,IAAI,CAAC,qBAAqB;YACnF,OAAO;QACT;QACA,MAAM,OAAO,KAAK,KAAK,CAAC,OAAO,IAAI,CAAC,SAAS,aAAa,QAAQ,CAAC;QACnE,IAAI,OAAO,KAAK,GAAG,KAAK,YAAY,KAAK,GAAG,GAAG,OAAO,KAAK,GAAG,IAAI;YAChE,OAAO;QACT;QACA,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 109, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/gtavapor/app/api/auth/login/route.ts"],"sourcesContent":["import { NextResponse, type NextRequest } from \"next/server\"\nimport { createSessionToken } from \"@/lib/auth/session\"\n\nexport async function POST(request: NextRequest) {\n  const { email, password } = await request.json()\n\n  if (!email || !password) {\n    return NextResponse.json({ message: \"Email dan password wajib diisi\" }, { status: 400 })\n  }\n\n  if (email !== process.env.APP_ADMIN_EMAIL || password !== process.env.APP_ADMIN_PASSWORD) {\n    return NextResponse.json({ message: \"Email atau password salah\" }, { status: 401 })\n  }\n\n  const token = await createSessionToken(email)\n  const response = NextResponse.json({ success: true })\n  response.cookies.set(\"session-token\", token, {\n    httpOnly: true,\n    sameSite: \"lax\",\n    secure: process.env.NODE_ENV === \"production\",\n    path: \"/\",\n    maxAge: 60 * 60 * 24 * 7,\n  })\n  return response\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;IAE9C,IAAI,CAAC,SAAS,CAAC,UAAU;QACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAiC,GAAG;YAAE,QAAQ;QAAI;IACxF;IAEA,IAAI,UAAU,QAAQ,GAAG,CAAC,eAAe,IAAI,aAAa,QAAQ,GAAG,CAAC,kBAAkB,EAAE;QACxF,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACnF;IAEA,MAAM,QAAQ,MAAM,IAAA,8IAAkB,EAAC;IACvC,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC;QAAE,SAAS;IAAK;IACnD,SAAS,OAAO,CAAC,GAAG,CAAC,iBAAiB,OAAO;QAC3C,UAAU;QACV,UAAU;QACV,QAAQ,oDAAyB;QACjC,MAAM;QACN,QAAQ,KAAK,KAAK,KAAK;IACzB;IACA,OAAO;AACT"}}]
}