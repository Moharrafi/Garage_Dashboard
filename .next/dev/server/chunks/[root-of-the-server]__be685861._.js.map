{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/gtavapor/lib/auth/session.ts"],"sourcesContent":["import { SignJWT, jwtVerify } from \"jose\"\n\nconst encoder = new TextEncoder()\n\nfunction getSecret() {\n  const secret = process.env.APP_SESSION_SECRET\n  if (!secret) {\n    throw new Error(\"APP_SESSION_SECRET is required\")\n  }\n  return encoder.encode(secret)\n}\n\nexport async function createSessionToken(email: string) {\n  const secret = getSecret()\n  return new SignJWT({ email })\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(\"7d\")\n    .sign(secret)\n}\n\nexport async function verifySessionToken(token: string) {\n  try {\n    const secret = getSecret()\n    const { payload } = await jwtVerify(token, secret)\n    return payload\n  } catch {\n    return null\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAEA,MAAM,UAAU,IAAI;AAEpB,SAAS;IACP,MAAM,SAAS,QAAQ,GAAG,CAAC,kBAAkB;IAC7C,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IACA,OAAO,QAAQ,MAAM,CAAC;AACxB;AAEO,eAAe,mBAAmB,KAAa;IACpD,MAAM,SAAS;IACf,OAAO,IAAI,QAAQ;QAAE;IAAM,GACxB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,MAClB,IAAI,CAAC;AACV;AAEO,eAAe,mBAAmB,KAAa;IACpD,IAAI;QACF,MAAM,SAAS;QACf,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,UAAU,OAAO;QAC3C,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/gtavapor/proxy.ts"],"sourcesContent":["import { verifySessionToken } from \"@/lib/auth/session\"\nimport { NextResponse, type NextRequest } from \"next/server\"\n\nconst publicPaths = [\n  \"/auth/login\",\n  \"/auth/sign-up\",\n  \"/api/auth/login\",\n  \"/api/auth/logout\",\n  \"/api/health\",\n  \"/favicon.ico\",\n]\n\nexport default async function proxy(request: NextRequest) {\n  const { pathname } = request.nextUrl\n  const isPublic = publicPaths.some((path) => pathname.startsWith(path))\n  const token = request.cookies.get(\"session-token\")?.value\n  const session = token ? await verifySessionToken(token) : null\n\n  if (!session && !isPublic && !pathname.startsWith(\"/_next\")) {\n    const url = request.nextUrl.clone()\n    url.pathname = \"/auth/login\"\n    url.searchParams.set(\"redirectedFrom\", pathname)\n    return NextResponse.redirect(url)\n  }\n\n  if (session && pathname.startsWith(\"/auth\")) {\n    const url = request.nextUrl.clone()\n    url.pathname = \"/\"\n    return NextResponse.redirect(url)\n  }\n\n  return NextResponse.next()\n}\n\nexport const config = {\n  matcher: [\"/((?!_next/static|_next/image|favicon.ico|.*\\\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)\"],\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,MAAM,cAAc;IAClB;IACA;IACA;IACA;IACA;IACA;CACD;AAEc,eAAe,MAAM,OAAoB;IACtD,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IACpC,MAAM,WAAW,YAAY,IAAI,CAAC,CAAC,OAAS,SAAS,UAAU,CAAC;IAChE,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,kBAAkB;IACpD,MAAM,UAAU,QAAQ,MAAM,IAAA,4IAAkB,EAAC,SAAS;IAE1D,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,UAAU,CAAC,WAAW;QAC3D,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;QACjC,IAAI,QAAQ,GAAG;QACf,IAAI,YAAY,CAAC,GAAG,CAAC,kBAAkB;QACvC,OAAO,6QAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,IAAI,WAAW,SAAS,UAAU,CAAC,UAAU;QAC3C,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;QACjC,IAAI,QAAQ,GAAG;QACf,OAAO,6QAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,OAAO,6QAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAoF;AAChG"}}]
}