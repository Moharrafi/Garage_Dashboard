{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/gtavapor/lib/db.ts"],"sourcesContent":["import mysql from \"mysql2/promise\"\n\nconst requiredEnv = [\"MYSQL_HOST\", \"MYSQL_PORT\", \"MYSQL_USER\", \"MYSQL_PASSWORD\", \"MYSQL_DATABASE\"] as const\n\nfor (const key of requiredEnv) {\n  if (!process.env[key]) {\n    throw new Error(`Missing required environment variable: ${key}`)\n  }\n}\n\nconst pool = mysql.createPool({\n  host: process.env.MYSQL_HOST,\n  port: Number(process.env.MYSQL_PORT),\n  user: process.env.MYSQL_USER,\n  password: process.env.MYSQL_PASSWORD,\n  database: process.env.MYSQL_DATABASE,\n  waitForConnections: true,\n  connectionLimit: Number(process.env.MYSQL_POOL_SIZE ?? 10),\n  timezone: \"+00:00\",\n})\n\nexport async function query<T>(sql: string, params: unknown[] = []) {\n  const [rows] = await pool.query(sql, params)\n  return rows as T\n}\n\nexport async function getConnection() {\n  return pool.getConnection()\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,cAAc;IAAC;IAAc;IAAc;IAAc;IAAkB;CAAiB;AAElG,KAAK,MAAM,OAAO,YAAa;IAC7B,IAAI,CAAC,QAAQ,GAAG,CAAC,IAAI,EAAE;QACrB,MAAM,IAAI,MAAM,CAAC,uCAAuC,EAAE,KAAK;IACjE;AACF;AAEA,MAAM,OAAO,8IAAK,CAAC,UAAU,CAAC;IAC5B,MAAM,QAAQ,GAAG,CAAC,UAAU;IAC5B,MAAM,OAAO,QAAQ,GAAG,CAAC,UAAU;IACnC,MAAM,QAAQ,GAAG,CAAC,UAAU;IAC5B,UAAU,QAAQ,GAAG,CAAC,cAAc;IACpC,UAAU,QAAQ,GAAG,CAAC,cAAc;IACpC,oBAAoB;IACpB,iBAAiB,OAAO,QAAQ,GAAG,CAAC,eAAe,IAAI;IACvD,UAAU;AACZ;AAEO,eAAe,MAAS,GAAW,EAAE,SAAoB,EAAE;IAChE,MAAM,CAAC,KAAK,GAAG,MAAM,KAAK,KAAK,CAAC,KAAK;IACrC,OAAO;AACT;AAEO,eAAe;IACpB,OAAO,KAAK,aAAa;AAC3B"}},
    {"offset": {"line": 159, "column": 0}, "map": {"version":3,"sources":["file:///C:/xampp/htdocs/gtavapor/app/api/units/%5Bid%5D/route.ts"],"sourcesContent":["import { NextResponse, type NextRequest } from \"next/server\"\nimport { query } from \"@/lib/db\"\nimport type { Unit } from \"@/lib/types\"\n\ntype RouteContext = {\n  params: Promise<{ id: string }> | { id: string }\n}\n\nasync function resolveParams(context: RouteContext) {\n  const possiblePromise = context.params\n  if (typeof (possiblePromise as Promise<{ id: string }>).then === \"function\") {\n    return (possiblePromise as Promise<{ id: string }>).then((value) => value)\n  }\n  return possiblePromise as { id: string }\n}\n\nconst allowedFields = new Set([\n  \"vehicle_type\",\n  \"brand\",\n  \"owner_name\",\n  \"phone\",\n  \"service_type\",\n  \"status\",\n  \"check_in_date\",\n  \"check_out_date\",\n  \"estimated_cost\",\n  \"final_cost\",\n  \"notes\",\n])\n\nexport async function PUT(request: NextRequest, context: RouteContext) {\n  const { id } = await resolveParams(context)\n  const updates = await request.json()\n  const fields: string[] = []\n  const values: unknown[] = []\n\n  for (const [key, value] of Object.entries(updates)) {\n    if (!allowedFields.has(key)) continue\n    fields.push(`${key} = ?`)\n    values.push(value)\n  }\n\n  if (fields.length === 0) {\n    return NextResponse.json({ message: \"Tidak ada data untuk diperbarui\" }, { status: 400 })\n  }\n\n  fields.push(\"updated_at = NOW()\")\n  await query(`UPDATE units SET ${fields.join(\", \")} WHERE id = ?`, [...values, id])\n  const [unit] = await query<Unit[]>(\"SELECT * FROM units WHERE id = ?\", [id])\n  const safeUnit = unit ? JSON.parse(JSON.stringify(unit)) : null\n  return NextResponse.json(safeUnit)\n}\n\nexport async function DELETE(_: NextRequest, context: RouteContext) {\n  const { id } = await resolveParams(context)\n  const result = await query<{ affectedRows?: number }>(\"DELETE FROM units WHERE id = ?\", [id])\n  const deleted = Array.isArray(result) ? result.length > 0 : Boolean(result?.affectedRows)\n  return NextResponse.json({ success: deleted })\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAOA,eAAe,cAAc,OAAqB;IAChD,MAAM,kBAAkB,QAAQ,MAAM;IACtC,IAAI,OAAO,AAAC,gBAA4C,IAAI,KAAK,YAAY;QAC3E,OAAO,AAAC,gBAA4C,IAAI,CAAC,CAAC,QAAU;IACtE;IACA,OAAO;AACT;AAEA,MAAM,gBAAgB,IAAI,IAAI;IAC5B;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAEM,eAAe,IAAI,OAAoB,EAAE,OAAqB;IACnE,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM,cAAc;IACnC,MAAM,UAAU,MAAM,QAAQ,IAAI;IAClC,MAAM,SAAmB,EAAE;IAC3B,MAAM,SAAoB,EAAE;IAE5B,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,OAAO,OAAO,CAAC,SAAU;QAClD,IAAI,CAAC,cAAc,GAAG,CAAC,MAAM;QAC7B,OAAO,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC;QACxB,OAAO,IAAI,CAAC;IACd;IAEA,IAAI,OAAO,MAAM,KAAK,GAAG;QACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAkC,GAAG;YAAE,QAAQ;QAAI;IACzF;IAEA,OAAO,IAAI,CAAC;IACZ,MAAM,IAAA,oHAAK,EAAC,CAAC,iBAAiB,EAAE,OAAO,IAAI,CAAC,MAAM,aAAa,CAAC,EAAE;WAAI;QAAQ;KAAG;IACjF,MAAM,CAAC,KAAK,GAAG,MAAM,IAAA,oHAAK,EAAS,oCAAoC;QAAC;KAAG;IAC3E,MAAM,WAAW,OAAO,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC,SAAS;IAC3D,OAAO,gJAAY,CAAC,IAAI,CAAC;AAC3B;AAEO,eAAe,OAAO,CAAc,EAAE,OAAqB;IAChE,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM,cAAc;IACnC,MAAM,SAAS,MAAM,IAAA,oHAAK,EAA4B,kCAAkC;QAAC;KAAG;IAC5F,MAAM,UAAU,MAAM,OAAO,CAAC,UAAU,OAAO,MAAM,GAAG,IAAI,QAAQ,QAAQ;IAC5E,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,SAAS;IAAQ;AAC9C"}}]
}